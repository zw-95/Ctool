import{u as T,i as k}from"./action-01192c39.js";import{d as z,y as D,z as H,r as d,A as M,B as I,a as w,k as v,x as s,w as m,j as i,F as U,q as j,c as L,C as y,T as R}from"./tool-ab65ccdd.js";import{C as a}from"./index-7f822afc.js";import{s as F}from"./index-aede4888.js";import"./modulepreload-polyfill-3cfb730f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-4caac7b0.js";import"./string_decoder-34e5f993.js";import"./index-04fc80b2.js";import"./index-5dad7b2e.js";const S=["md5","sha1","sha256","sha512","sm3","ripemd160"],V={md5:(r,t)=>a.HmacMD5(a.enc.Base64.parse(r.toBase64()),a.enc.Base64.parse(t.toBase64())).toString(),sha1:(r,t)=>a.HmacSHA1(a.enc.Base64.parse(r.toBase64()),a.enc.Base64.parse(t.toBase64())).toString(),sha256:(r,t)=>a.HmacSHA256(a.enc.Base64.parse(r.toBase64()),a.enc.Base64.parse(t.toBase64())).toString(),sha512:(r,t)=>a.HmacSHA512(a.enc.Base64.parse(r.toBase64()),a.enc.Base64.parse(t.toBase64())).toString(),sm3:(r,t)=>{const h=(l,n)=>l.length>=n?l:new Array(n-l.length+1).join("0")+l;let e=r.toHexString();const f=[];let _=e.length;_%2!==0&&(e=h(e,_+1)),_=e.length;for(let l=0;l<_;l+=2)f.push(parseInt(e.substr(l,2),16));return F.sm3(f,{key:t.toHexString()})},ripemd160:(r,t)=>a.HmacRIPEMD160(a.enc.Base64.parse(r.toBase64()),a.enc.Base64.parse(t.toBase64())).toString()},A=(r,t,h)=>{if(!Object.keys(V).includes(r))throw new Error(`hmac method 不存在: ${r}`);return V[r](t,h)},Y=z({__name:"Hmac",async setup(r){let t,h;const e=T(([t,h]=D(()=>k({input:y(),secret:y("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),f=H(()=>["text"].includes(e.current.input.type)),_=H(()=>{let n={md5:"",sha1:"",sha256:"",sha512:"",sm3:"",ripemd160:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return n;let o=!1;for(let u of S)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const c=l(u,e.current.input.text,e.current.secret.text,f.value&&e.current.multiple);n[u]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){o=!0,n[u]=$error(c)}return o||e.save(),n}),l=(n,o,u,c)=>c?o.toString().split(`
`).map(B=>A(n,R.fromString(B,o.encoding()),u)).join(`
`):A(n,o,u);return(n,o)=>{const u=d("TextInput"),c=d("HeightResize"),B=d("Bool"),b=d("Tooltip"),x=d("Align"),C=d("Display"),E=d("Textarea"),$=M("row");return I((w(),v("div",null,[s(x,{direction:"vertical"},{default:m(()=>[s(u,{class:"ctool-page-option",modelValue:i(e).current.secret,"onUpdate:modelValue":o[0]||(o[0]=p=>i(e).current.secret=p),"use-input":n.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),s(C,null,{extra:m(()=>[s(x,null,{default:m(()=>[s(B,{size:"small",modelValue:i(e).current.is_uppercase,"onUpdate:modelValue":o[2]||(o[2]=p=>i(e).current.is_uppercase=p),border:"",label:n.$t("hmac_uppercase")},null,8,["modelValue","label"]),s(b,{content:n.$t("hmac_multiple_tooltip")},{default:m(()=>[s(B,{disabled:!f.value,size:"small",modelValue:i(e).current.multiple,"onUpdate:modelValue":o[3]||(o[3]=p=>i(e).current.multiple=p),border:"",label:n.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[s(c,{append:[".ctool-page-option"],reduce:5},{default:m(({height:p})=>[s(u,{modelValue:i(e).current.input,"onUpdate:modelValue":o[1]||(o[1]=g=>i(e).current.input=g),height:p,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1},8,["append"])]),_:1})]),_:1}),s(c,null,{default:m(({height:p})=>[s(x,{direction:"vertical"},{default:m(()=>[(w(!0),v(U,null,j(i(S),g=>(w(),L(E,{"model-value":_.value[g],height:(p-20)/i(S).length,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[$,"10-14"]])}}});export{Y as default};
